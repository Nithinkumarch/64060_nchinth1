---
title: "BA_Regression"
author: "Chinthakindi Nithin Kumar"
date: "2023-11-05"
output:
  word_document: default
  html_document: default
  pdf_document: default
---
```{r}

```
1. Run the following code in R-studio to create two variables X and Y.
set.seed(2017)
X=runif(100)*10
Y=X*4+3.45
Y=rnorm(100)*0.29*Y+Y 

```{r}
set.seed(2017)
X=runif(100)*10
Y=X*4+3.45
Y=rnorm(100)*0.29*Y+Y 

```
A) Plot Y against X. Include a screenshot of the plot in your submission. Using the File menu you can save the graph as a picture on your computer. Based on the plot do you think we can fit a linear model to explain Y based on X?

```{r}
plot(Y~X,xlab='X',ylab='Y',col='green')
abline(lsfit(X, Y),col = "black")

```
B) Construct a simple linear model of Y based on X. Write the equation that explains Y based on X. What is the accuracy of this model?

Y=4.4655+3.6108*X
Accuracy is 0.6517 or 65%
```{r}
fit <- lm(Y ~ X)
summary(fit)
```
C) How the Coefficient of Determination, R2, of the model above is related to the correlation coefficient of X and Y?

```{r}
cor(X,Y)^2
```
Solution: The square of correlation coefficient is same as coefficient of determination 65.17% 
#Coefficient of Determination= (Correlation Coefficient)2

2. We will use the ‘mtcars’ dataset for this question. The dataset is already included in your R distribution. The dataset shows some of the characteristics of different cars. The following shows few samples (i.e. the first 6 rows) of the dataset. The description of the dataset can be found here.

```{r}
head(mtcars)
```
A) James wants to buy a car. He and his friend, Chris, have different opinions about the Horse Power (hp) of cars. James think the weight of a car (wt) can be used to estimate the Horse Power of the car while Chris thinks the fuel consumption expressed in Mile Per Gallon (mpg), is a better estimator of the (hp). Who do you think is right? Construct simple linear models using mtcars data to answer the question

```{r}
plot(mtcars$hp~mtcars$wt,xlab='Weight',ylab='HP',col='pink')
abline(lsfit(mtcars$wt,mtcars$hp),col = "brown")
Model1<-lm(formula =hp~wt, data = mtcars )
summary(Model1)
```
Accuracy of Model1 is 0.4339.
Building a model based on Chris estimation:
```{r}
plot(mtcars$hp~mtcars$mpg,xlab='MPG',ylab='HP',col='blue')
abline(lsfit(mtcars$mpg, mtcars$hp),col = "red")
Model2<-lm(formula =hp~mpg, data = mtcars )
summary(Model2)
```
Accuracy of the model2 is 0.6024
Conclusion: Chris's estimation is reasonably accurate. Chris is therefore correct.

B) Build a model that uses the number of cylinders (cyl) and the mile per gallon (mpg) values of a car to predict the car Horse Power (hp). Using this model, what is the estimated Horse Power of a car with 4 calendar and mpg of 22?

```{r}
Model3<-lm(hp~cyl+mpg,data = mtcars)
summary(Model3)
estimated_HP<-predict(Model3,data.frame(cyl=4,mpg=22))
estimated_HP
```
3. For this question, we are going to use BostonHousing dataset. The dataset is in ‘mlbench’ package, so we first need to instal the package, call the library and the load the dataset using the following commands

```{r}
library(mlbench)
data(BostonHousing)

```

A) Build a model to estimate the median value of owner-occupied homes (medv)based on the following variables: crime crate (crim), proportion of residential land zoned for lots over 25,000 sq.ft (zn), the local pupil-teacher ratio (ptratio) and weather the whether the tract bounds Chas River(chas). Is this an accurate model? (Hint check R2 )

```{r}
set.seed(123)
Model4<-lm(medv~crim+zn+ptratio+chas,data = BostonHousing)
summary(Model4)
```
The Model Accuracy is 0.3599. The Model is not Accurate enough.

B) Use the estimated coefficient to answer these questions?

i) Imagine two houses that are identical in all aspects but one bounds the Chas River and the other does not. Which one is more expensive and by how much

Answer:  Factors '0' and '1' comprise Chas. "1" denotes a person who is within the boundaries of the Chas River, while "0" denotes someone who isn't.The data description states that the median value of owner-occupied homes is $1,000, and the coefficient of chas1 is 4.58393. The result of multiplying by the coefficient is 4583.93$, which is a costly amount.

ii) Imagine two houses that are identical in all aspects but in the neighborhood of one of them the pupil-teacher ratio is 15 and in the other one is 18. Which one is more expensive and by how much

Answer: In thousands, the price of a house decreases by 1.49367, or 1493.67, for every unit increase in ptratio.There will be a decrease of 15 * 1493.67 = 22405.05. If ptratio is 15. Likewise, there will be a decrease of 18 * 1493.67 = 26886.06 if ptratio is 18.Therefore, if the PT ratio is 15 and the PT ratio is 18, the difference is $4481.01.

C) Which of the variables are statistically important (i.e. related to the house price)? Hint: use the p-values of the coefficients to answer

Answer: Indeed, we can safely reject the default null hypothesis—that is, the idea that there is no relationship between house price and other variables in the model—because the p-values of all the variables do not equal zero. Therefore, each and every variable has statistical significance.

D) Use the anova analysis and determine the order of importance of these four variables

```{r}
anova(Model4)
```
Answer: It is evident that the crim variable explains a substantially larger amount of variability (sum squared) than the other variables. We could surmise that the model was greatly enhanced by the addition of the crim. However, residuals indicate that a significant amount of variability remains unexplained.





